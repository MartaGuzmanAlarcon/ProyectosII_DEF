%aceptable
filename_1 = "AcceptableFiles.txt";
acc_file = fopen(filename_1,'w+');
meanVector_accFile = zeros(0,12);

files = {'set-a/1002867.txt','set-a/1005639.txt','set-a/1007823.txt','set-a/1009404.txt','set-a/1009856.txt','set-a/1013179.txt','set-a/1015620.txt','set-a/1021036.txt','set-a/1027085.txt','set-a/1027294.txt','set-a/1028505.txt','set-a/1029390.txt','set-a/1029776.txt','set-a/1031414.txt','set-a/1035858.txt','set-a/1041530.txt','set-a/1045434.txt','set-a/1049030.txt','set-a/1053871.txt','set-a/1058551.txt','set-a/1062220.txt','set-a/1066522.txt','set-a/1066648.txt','set-a/1066767.txt','set-a/1067343.txt','set-a/1068169.txt','set-a/1071514.txt','set-a/1073952.txt','set-a/1073996.txt','set-a/1074828.txt','set-a/1075113.txt','set-a/1084750.txt','set-a/1085234.txt','set-a/1085468.txt','set-a/1095208.txt','set-a/1097104.txt','set-a/1098180.txt','set-a/1098605.txt','set-a/1098634.txt','set-a/1101252.txt','set-a/1102129.txt','set-a/1102445.txt','set-a/1105148.txt','set-a/1108131.txt','set-a/1108642.txt','set-a/1109779.txt','set-a/1112518.txt','set-a/1115111.txt','set-a/1116393.txt','set-a/1122248.txt','set-a/1124627.txt','set-a/1129323.txt','set-a/1129523.txt','set-a/1133939.txt','set-a/1134074.txt','set-a/1137606.txt','set-a/1138505.txt','set-a/1139243.txt','set-a/1144476.txt','set-a/1146503.txt','set-a/1157735.txt','set-a/1165660.txt','set-a/1166425.txt','set-a/1168042.txt','set-a/1168914.txt','set-a/1173628.txt','set-a/1176338.txt','set-a/1178618.txt','set-a/1179983.txt','set-a/1185077.txt','set-a/1186453.txt','set-a/1192519.txt','set-a/1194123.txt','set-a/1197142.txt','set-a/1201815.txt','set-a/1202023.txt','set-a/1203950.txt','set-a/1206548.txt','set-a/1208494.txt','set-a/1223204.txt','set-a/1224250.txt','set-a/1225426.txt','set-a/1227497.txt','set-a/1228058.txt','set-a/1232746.txt','set-a/1234270.txt','set-a/1234318.txt','set-a/1238368.txt','set-a/1240272.txt','set-a/1247012.txt','set-a/1256457.txt','set-a/1260448.txt','set-a/1268034.txt','set-a/1273536.txt','set-a/1274881.txt','set-a/1281719.txt','set-a/1282270.txt','set-a/1284537.txt','set-a/1286932.txt','set-a/1289729.txt','set-a/1292232.txt','set-a/1294425.txt','set-a/1295971.txt','set-a/1297159.txt','set-a/1300479.txt','set-a/1308563.txt','set-a/1315318.txt','set-a/1315625.txt','set-a/1318684.txt','set-a/1320361.txt','set-a/1322081.txt','set-a/1322614.txt','set-a/1323643.txt','set-a/1326638.txt','set-a/1327350.txt','set-a/1328818.txt','set-a/1330771.txt','set-a/1337564.txt','set-a/1344909.txt','set-a/1346485.txt','set-a/1348870.txt','set-a/1350943.txt','set-a/1353271.txt','set-a/1353453.txt','set-a/1354128.txt','set-a/1354464.txt','set-a/1361018.txt','set-a/1363100.txt','set-a/1364873.txt','set-a/1365861.txt','set-a/1369340.txt','set-a/1370341.txt','set-a/1370857.txt','set-a/1373397.txt','set-a/1374579.txt','set-a/1379675.txt','set-a/1385312.txt','set-a/1392454.txt','set-a/1392742.txt','set-a/1394231.txt','set-a/1398947.txt','set-a/1399026.txt','set-a/1400164.txt','set-a/1410400.txt','set-a/1413908.txt','set-a/1417937.txt','set-a/1421197.txt','set-a/1422805.txt','set-a/1423770.txt','set-a/1427169.txt','set-a/1429007.txt','set-a/1434029.txt','set-a/1442274.txt','set-a/1443107.txt','set-a/1444673.txt','set-a/1447487.txt','set-a/1450308.txt','set-a/1452327.txt','set-a/1452994.txt','set-a/1454075.txt','set-a/1454713.txt','set-a/1464647.txt','set-a/1465628.txt','set-a/1470027.txt','set-a/1475480.txt','set-a/1477893.txt','set-a/1482286.txt','set-a/1483081.txt','set-a/1484553.txt','set-a/1486229.txt','set-a/1488119.txt','set-a/1501992.txt','set-a/1508620.txt','set-a/1515604.txt','set-a/1516498.txt','set-a/1517111.txt','set-a/1522800.txt','set-a/1523786.txt','set-a/1525834.txt','set-a/1527083.txt','set-a/1534710.txt','set-a/1537149.txt','set-a/1538846.txt','set-a/1545231.txt','set-a/1548723.txt','set-a/1553666.txt','set-a/1561454.txt','set-a/1563789.txt','set-a/1567711.txt','set-a/1568777.txt','set-a/1569173.txt','set-a/1578908.txt','set-a/1579902.txt','set-a/1580630.txt','set-a/1581950.txt','set-a/1583796.txt','set-a/1583812.txt','set-a/1588250.txt','set-a/1588964.txt','set-a/1595195.txt','set-a/1599410.txt','set-a/1599507.txt','set-a/1601254.txt','set-a/1603086.txt','set-a/1609558.txt','set-a/1609698.txt','set-a/1611606.txt','set-a/1616997.txt','set-a/1618986.txt','set-a/1620867.txt','set-a/1622571.txt','set-a/1624761.txt','set-a/1631117.txt','set-a/1636043.txt','set-a/1638703.txt','set-a/1638919.txt','set-a/1642201.txt','set-a/1652924.txt','set-a/1656657.txt','set-a/1660582.txt','set-a/1664978.txt','set-a/1665193.txt','set-a/1666159.txt','set-a/1667927.txt','set-a/1668124.txt','set-a/1668529.txt','set-a/1668584.txt','set-a/1671316.txt','set-a/1671814.txt','set-a/1673109.txt','set-a/1681852.txt','set-a/1682186.txt','set-a/1685808.txt','set-a/1690426.txt','set-a/1695837.txt','set-a/1696366.txt','set-a/1698287.txt','set-a/1699208.txt','set-a/1700830.txt','set-a/1702323.txt','set-a/1703637.txt','set-a/1708002.txt','set-a/1708413.txt','set-a/1710505.txt','set-a/1710636.txt','set-a/1714341.txt','set-a/1715038.txt','set-a/1715358.txt','set-a/1721551.txt','set-a/1722508.txt','set-a/1723360.txt','set-a/1733240.txt','set-a/1735742.txt','set-a/1738541.txt','set-a/1741864.txt','set-a/1743130.txt','set-a/1746739.txt','set-a/1747208.txt','set-a/1750516.txt','set-a/1751199.txt','set-a/1755721.txt','set-a/1755843.txt','set-a/1756189.txt','set-a/1757718.txt','set-a/1763095.txt','set-a/1765752.txt','set-a/1770133.txt','set-a/1770296.txt','set-a/1771965.txt','set-a/1773240.txt','set-a/1773750.txt','set-a/1775694.txt','set-a/1780407.txt','set-a/1782049.txt','set-a/1782798.txt','set-a/1788500.txt','set-a/1788608.txt','set-a/1791632.txt','set-a/1804217.txt','set-a/1806299.txt','set-a/1811683.txt','set-a/1812105.txt','set-a/1817290.txt','set-a/1821035.txt','set-a/1827723.txt','set-a/1827761.txt','set-a/1828498.txt','set-a/1829617.txt','set-a/1833468.txt','set-a/1834084.txt','set-a/1835001.txt','set-a/1836357.txt','set-a/1840439.txt','set-a/1846826.txt','set-a/1849331.txt','set-a/1852268.txt','set-a/1854368.txt','set-a/1865054.txt','set-a/1866166.txt','set-a/1867128.txt','set-a/1867357.txt','set-a/1868463.txt','set-a/1876194.txt','set-a/1883194.txt','set-a/1883568.txt','set-a/1884916.txt','set-a/1886185.txt','set-a/1886325.txt','set-a/1887783.txt','set-a/1887789.txt','set-a/1894887.txt','set-a/1896185.txt','set-a/1896309.txt','set-a/1897412.txt','set-a/1900734.txt','set-a/1902658.txt','set-a/1903803.txt','set-a/1904144.txt','set-a/1905774.txt','set-a/1908226.txt','set-a/1911646.txt','set-a/1920459.txt','set-a/1920585.txt','set-a/1929319.txt','set-a/1931029.txt','set-a/1931114.txt','set-a/1936185.txt','set-a/1937641.txt','set-a/1941866.txt','set-a/1952013.txt','set-a/1952579.txt','set-a/1955321.txt','set-a/1955721.txt','set-a/1959699.txt','set-a/1960918.txt','set-a/1962175.txt','set-a/1962761.txt','set-a/1964056.txt','set-a/1966933.txt','set-a/1968453.txt','set-a/1975327.txt','set-a/1980518.txt','set-a/1985543.txt','set-a/1988148.txt','set-a/1988534.txt','set-a/1988935.txt','set-a/1995171.txt','set-a/2000100.txt','set-a/2002988.txt','set-a/2007358.txt','set-a/2009094.txt','set-a/2012013.txt','set-a/2014715.txt','set-a/2014944.txt','set-a/2017032.txt','set-a/2028227.txt','set-a/2030852.txt','set-a/2032772.txt','set-a/2036732.txt','set-a/2037566.txt','set-a/2042596.txt','set-a/2050011.txt','set-a/2050741.txt','set-a/2051346.txt','set-a/2053736.txt','set-a/2058401.txt','set-a/2059468.txt','set-a/2059529.txt','set-a/2060317.txt','set-a/2064122.txt','set-a/2064276.txt','set-a/2065033.txt','set-a/2069864.txt','set-a/2070076.txt','set-a/2071665.txt','set-a/2075786.txt','set-a/2080148.txt','set-a/2080991.txt','set-a/2081656.txt','set-a/2083132.txt','set-a/2086672.txt','set-a/2087383.txt','set-a/2090560.txt','set-a/2103996.txt','set-a/2108482.txt','set-a/2111660.txt','set-a/2115548.txt','set-a/2115563.txt','set-a/2116010.txt','set-a/2116467.txt','set-a/2116607.txt','set-a/2117622.txt','set-a/2123133.txt','set-a/2124174.txt','set-a/2124273.txt','set-a/2126232.txt','set-a/2126588.txt','set-a/2127352.txt','set-a/2128145.txt','set-a/2129226.txt','set-a/2131431.txt','set-a/2139134.txt','set-a/2140454.txt','set-a/2140960.txt','set-a/2142549.txt','set-a/2143366.txt','set-a/2145815.txt','set-a/2145997.txt','set-a/2146598.txt','set-a/2148930.txt','set-a/2149558.txt','set-a/2151032.txt','set-a/2156455.txt','set-a/2159212.txt','set-a/2159438.txt','set-a/2165787.txt','set-a/2167590.txt','set-a/2169603.txt','set-a/2171095.txt','set-a/2176325.txt','set-a/2180861.txt','set-a/2181130.txt','set-a/2181292.txt','set-a/2183949.txt','set-a/2188460.txt','set-a/2188908.txt','set-a/2189496.txt','set-a/2191038.txt','set-a/2191320.txt','set-a/2193848.txt','set-a/2196143.txt','set-a/2197904.txt','set-a/2201932.txt','set-a/2208819.txt','set-a/2209199.txt','set-a/2209473.txt','set-a/2209843.txt','set-a/2216756.txt','set-a/2217973.txt','set-a/2218118.txt','set-a/2220115.txt','set-a/2220284.txt','set-a/2221828.txt','set-a/2224335.txt','set-a/2225874.txt','set-a/2229804.txt','set-a/2235048.txt','set-a/2236690.txt','set-a/2237474.txt','set-a/2239530.txt','set-a/2242351.txt','set-a/2243674.txt','set-a/2245095.txt','set-a/2247636.txt','set-a/2248266.txt','set-a/2249000.txt','set-a/2251481.txt','set-a/2251998.txt','set-a/2256597.txt','set-a/2262723.txt','set-a/2263952.txt','set-a/2265291.txt','set-a/2266555.txt','set-a/2272561.txt','set-a/2275712.txt','set-a/2289479.txt','set-a/2295527.txt','set-a/2299854.txt','set-a/2301647.txt','set-a/2301687.txt','set-a/2307962.txt','set-a/2310522.txt','set-a/2312233.txt','set-a/2314213.txt','set-a/2319354.txt','set-a/2321199.txt','set-a/2325916.txt','set-a/2332148.txt','set-a/2332742.txt','set-a/2333085.txt','set-a/2339728.txt','set-a/2347050.txt','set-a/2352232.txt','set-a/2354985.txt','set-a/2356467.txt','set-a/2356999.txt','set-a/2357247.txt','set-a/2358887.txt','set-a/2359743.txt','set-a/2360557.txt','set-a/2362692.txt','set-a/2367508.txt','set-a/2368294.txt','set-a/2369355.txt','set-a/2370006.txt','set-a/2371047.txt','set-a/2371170.txt','set-a/2376318.txt','set-a/2381167.txt','set-a/2381242.txt','set-a/2382091.txt','set-a/2382797.txt','set-a/2383056.txt','set-a/2383851.txt','set-a/2387661.txt','set-a/2388751.txt','set-a/2392598.txt','set-a/2395204.txt','set-a/2395721.txt','set-a/2399814.txt','set-a/2400687.txt','set-a/2403917.txt','set-a/2404591.txt','set-a/2406161.txt','set-a/2408689.txt','set-a/2409959.txt','set-a/2410367.txt','set-a/2412987.txt','set-a/2419141.txt','set-a/2421678.txt','set-a/2424388.txt','set-a/2425122.txt','set-a/2425662.txt','set-a/2427324.txt','set-a/2428645.txt','set-a/2429191.txt','set-a/2436056.txt','set-a/2436645.txt','set-a/2440446.txt','set-a/2440596.txt','set-a/2441636.txt','set-a/2445398.txt','set-a/2445407.txt','set-a/2449723.txt','set-a/2454325.txt','set-a/2458889.txt','set-a/2460512.txt','set-a/2462572.txt','set-a/2466032.txt','set-a/2467487.txt','set-a/2470929.txt','set-a/2472828.txt','set-a/2475408.txt','set-a/2477521.txt','set-a/2479911.txt','set-a/2480414.txt','set-a/2481324.txt','set-a/2482938.txt','set-a/2483752.txt','set-a/2489947.txt','set-a/2493339.txt','set-a/2493575.txt','set-a/2494912.txt','set-a/2496130.txt','set-a/2496710.txt','set-a/2497511.txt','set-a/2497982.txt','set-a/2501210.txt','set-a/2502698.txt','set-a/2508679.txt','set-a/2511400.txt','set-a/2511429.txt','set-a/2514603.txt','set-a/2516572.txt','set-a/2520126.txt','set-a/2522140.txt','set-a/2522809.txt','set-a/2526829.txt','set-a/2526840.txt','set-a/2527240.txt','set-a/2531098.txt','set-a/2535257.txt','set-a/2536401.txt','set-a/2537839.txt','set-a/2539200.txt','set-a/2539535.txt','set-a/2542883.txt','set-a/2543809.txt','set-a/2550021.txt','set-a/2550576.txt','set-a/2550752.txt','set-a/2552081.txt','set-a/2552509.txt','set-a/2552850.txt','set-a/2553107.txt','set-a/2554462.txt','set-a/2559273.txt','set-a/2561007.txt','set-a/2564457.txt','set-a/2568209.txt','set-a/2568577.txt','set-a/2570632.txt','set-a/2577576.txt','set-a/2580428.txt','set-a/2582792.txt','set-a/2584163.txt','set-a/2590292.txt','set-a/2590706.txt','set-a/2591877.txt','set-a/2593475.txt','set-a/2594132.txt','set-a/2595883.txt','set-a/2597810.txt','set-a/2600606.txt','set-a/2601912.txt','set-a/2607425.txt','set-a/2608118.txt','set-a/2610344.txt','set-a/2615830.txt','set-a/2615913.txt','set-a/2618783.txt','set-a/2620389.txt','set-a/2621016.txt','set-a/2622365.txt','set-a/2622993.txt','set-a/2627461.txt','set-a/2636120.txt','set-a/2640483.txt','set-a/2647986.txt','set-a/2650422.txt','set-a/2651374.txt','set-a/2653435.txt','set-a/2654737.txt','set-a/2658563.txt','set-a/2660896.txt','set-a/2668141.txt','set-a/2670321.txt','set-a/2675532.txt','set-a/2677449.txt','set-a/2678169.txt','set-a/2678574.txt','set-a/2679451.txt','set-a/2681017.txt','set-a/2682348.txt','set-a/2682608.txt','set-a/2682746.txt','set-a/2684516.txt','set-a/2689382.txt','set-a/2690686.txt','set-a/2691158.txt','set-a/2693989.txt','set-a/2695524.txt','set-a/2701290.txt','set-a/2702081.txt','set-a/2705121.txt','set-a/2710359.txt','set-a/2711879.txt','set-a/2718367.txt','set-a/2721033.txt','set-a/2723883.txt','set-a/2726297.txt','set-a/2729748.txt','set-a/2730157.txt','set-a/2730999.txt','set-a/2733620.txt','set-a/2738514.txt','set-a/2749999.txt','set-a/2751372.txt','set-a/2753468.txt','set-a/2757008.txt','set-a/2758135.txt','set-a/2760946.txt','set-a/2764726.txt','set-a/2766576.txt','set-a/2766606.txt','set-a/2770354.txt','set-a/2771224.txt','set-a/2771437.txt','set-a/2771970.txt','set-a/2772856.txt','set-a/2773243.txt','set-a/2773537.txt','set-a/2776665.txt','set-a/2781287.txt','set-a/2781601.txt','set-a/2786141.txt','set-a/2788838.txt','set-a/2788968.txt','set-a/2789383.txt','set-a/2790899.txt','set-a/2791114.txt','set-a/2794498.txt','set-a/2794622.txt','set-a/2800968.txt','set-a/2800977.txt','set-a/2801034.txt','set-a/2803209.txt','set-a/2803241.txt','set-a/2803643.txt','set-a/2804853.txt','set-a/2805557.txt','set-a/2809815.txt','set-a/2811441.txt','set-a/2812632.txt','set-a/2813478.txt','set-a/2813547.txt','set-a/2822611.txt','set-a/2825450.txt','set-a/2829584.txt','set-a/2830227.txt','set-a/2830745.txt','set-a/2831246.txt','set-a/2832166.txt','set-a/2833796.txt','set-a/2836333.txt','set-a/2840951.txt','set-a/2842563.txt','set-a/2846577.txt','set-a/2846962.txt','set-a/2855979.txt','set-a/2860703.txt','set-a/2863391.txt','set-a/2863747.txt','set-a/2863862.txt','set-a/2865486.txt','set-a/2865717.txt','set-a/2868054.txt','set-a/2869593.txt','set-a/2873998.txt','set-a/2878374.txt','set-a/2878973.txt','set-a/2880070.txt','set-a/2880840.txt','set-a/2882409.txt','set-a/2883516.txt','set-a/2887552.txt','set-a/2887976.txt','set-a/2887999.txt','set-a/2888324.txt','set-a/2890081.txt','set-a/2891502.txt','set-a/2891576.txt','set-a/2893432.txt','set-a/2897997.txt','set-a/2898976.txt','set-a/2899476.txt','set-a/2901024.txt','set-a/2903242.txt','set-a/2910600.txt','set-a/2916186.txt','set-a/2918084.txt','set-a/2919114.txt','set-a/2920995.txt','set-a/2923723.txt','set-a/2926949.txt','set-a/2930441.txt','set-a/2932791.txt','set-a/2933532.txt','set-a/2934316.txt','set-a/2938282.txt','set-a/2943601.txt','set-a/2944449.txt','set-a/2945198.txt','set-a/2945456.txt','set-a/2954283.txt','set-a/2956139.txt','set-a/2958210.txt','set-a/2958981.txt','set-a/2959985.txt','set-a/2960522.txt','set-a/2962246.txt','set-a/2969546.txt','set-a/2970961.txt','set-a/2972344.txt','set-a/2975201.txt','set-a/2981187.txt','set-a/2982047.txt','set-a/2984955.txt','set-a/2988640.txt','set-a/2989662.txt','set-a/2994306.txt','set-a/2995146.txt','set-a/2996573.txt'};

for i = 1:length(files) 
     file = files{i} ;
     [filepath,name,ext] = fileparts(file);
    for lead = 2:13
         [kSQI_01_v,sSQI_01_v, pSQI_01_v, SQI_rel_powerLine_01_v,cSQI_01_v, basSQI_01_v,dSQI_01_v,geometricMean_V,averageGeometricMean] = mSQI(ImportPhysionetData(file, lead), 500);
         meanVector_accFile(lead-1) = averageGeometricMean;
         fprintf("Indexes for %s, lead %i:  averageGeometricMean: %f \n ",file,lead,averageGeometricMean);
    end
    index1 = mean(meanVector_accFile);
    index2 = geomean(meanVector_accFile,'all');
    meanVector_changed = changeZeros(meanVector_accFile);
    index3 = geomean(meanVector_changed);
    arit_mean = round(index1,5);
    geo_mean1 = round(index2,5);
    geo_mean2 = round(index3,5);
    fprintf(acc_file,'%s ',name);

for j  = 1:length(meanVector_accFile)
     fprintf(acc_file,'%f ',meanVector_accFile(j));
end

    fprintf(acc_file,'%f ',arit_mean);
    fprintf(acc_file,'%f ',geo_mean1);
    fprintf(acc_file,'%f\n',geo_mean2);
end 

fclose(acc_file);

%unaceptable
filename_2 = "UnacceptableFiles.txt";
unacc_file = fopen(filename_2,'w+');
meanVector_unaccFile = zeros(0,12);

files = {'set-a/1002603.txt','set-a/1003574.txt','set-a/1004502.txt','set-a/1006637.txt','set-a/1028102.txt','set-a/1030400.txt','set-a/1030943.txt','set-a/1034914.txt','set-a/1038105.txt','set-a/1050325.txt','set-a/1052879.txt','set-a/1063069.txt','set-a/1063073.txt','set-a/1068152.txt','set-a/1072620.txt','set-a/1076589.txt','set-a/1079854.txt','set-a/1086219.txt','set-a/1089267.txt','set-a/1101829.txt','set-a/1105115.txt','set-a/1129899.txt','set-a/1136617.txt','set-a/1136770.txt','set-a/1138841.txt','set-a/1139166.txt','set-a/1149244.txt','set-a/1156063.txt','set-a/1163558.txt','set-a/1164815.txt','set-a/1169320.txt','set-a/1180858.txt','set-a/1183223.txt','set-a/1183818.txt','set-a/1192090.txt','set-a/1192637.txt','set-a/1202296.txt','set-a/1220041.txt','set-a/1221733.txt','set-a/1243537.txt','set-a/1254724.txt','set-a/1255536.txt','set-a/1279102.txt','set-a/1295738.txt','set-a/1301273.txt','set-a/1301328.txt','set-a/1317495.txt','set-a/1327085.txt','set-a/1327659.txt','set-a/1335760.txt','set-a/1337378.txt','set-a/1344978.txt','set-a/1347106.txt','set-a/1354265.txt','set-a/1355055.txt','set-a/1356379.txt','set-a/1356529.txt','set-a/1363712.txt','set-a/1364918.txt','set-a/1369305.txt','set-a/1377360.txt','set-a/1377539.txt','set-a/1382942.txt','set-a/1403997.txt','set-a/1408675.txt','set-a/1421230.txt','set-a/1425383.txt','set-a/1435087.txt','set-a/1436962.txt','set-a/1451509.txt','set-a/1452192.txt','set-a/1454865.txt','set-a/1463775.txt','set-a/1474710.txt','set-a/1480991.txt','set-a/1485621.txt','set-a/1490937.txt','set-a/1509036.txt','set-a/1531776.txt','set-a/1532215.txt','set-a/1553541.txt','set-a/1556297.txt','set-a/1568146.txt','set-a/1607439.txt','set-a/1609343.txt','set-a/1610034.txt','set-a/1628173.txt','set-a/1636307.txt','set-a/1648581.txt','set-a/1661380.txt','set-a/1669522.txt','set-a/1670989.txt','set-a/1691516.txt','set-a/1700006.txt','set-a/1703846.txt','set-a/1707186.txt','set-a/1708868.txt','set-a/1722066.txt','set-a/1725585.txt','set-a/1730951.txt','set-a/1756508.txt','set-a/1770220.txt','set-a/1772249.txt','set-a/1777141.txt','set-a/1781728.txt','set-a/1789020.txt','set-a/1791997.txt','set-a/1795070.txt','set-a/1815022.txt','set-a/1815563.txt','set-a/1816501.txt','set-a/1819445.txt','set-a/1836026.txt','set-a/1852649.txt','set-a/1882255.txt','set-a/1896934.txt','set-a/1897448.txt','set-a/1902736.txt','set-a/1906060.txt','set-a/1942060.txt','set-a/1943228.txt','set-a/1948708.txt','set-a/1951446.txt','set-a/1953759.txt','set-a/1961627.txt','set-a/1968052.txt','set-a/1980306.txt','set-a/2029246.txt','set-a/2052791.txt','set-a/2063503.txt','set-a/2064180.txt','set-a/2082473.txt','set-a/2085388.txt','set-a/2098595.txt','set-a/2110250.txt','set-a/2111450.txt','set-a/2117407.txt','set-a/2127139.txt','set-a/2140359.txt','set-a/2145403.txt','set-a/2151929.txt','set-a/2152580.txt','set-a/2167341.txt','set-a/2212042.txt','set-a/2213956.txt','set-a/2224949.txt','set-a/2230467.txt','set-a/2233440.txt','set-a/2240739.txt','set-a/2241695.txt','set-a/2246806.txt','set-a/2251502.txt','set-a/2271306.txt','set-a/2271513.txt','set-a/2280128.txt','set-a/2294899.txt','set-a/2298270.txt','set-a/2307927.txt','set-a/2326500.txt','set-a/2327647.txt','set-a/2329269.txt','set-a/2331194.txt','set-a/2338564.txt','set-a/2342679.txt','set-a/2352525.txt','set-a/2367143.txt','set-a/2368502.txt','set-a/2373003.txt','set-a/2378950.txt','set-a/2380637.txt','set-a/2386741.txt','set-a/2402945.txt','set-a/2407768.txt','set-a/2420975.txt','set-a/2428298.txt','set-a/2429146.txt','set-a/2431794.txt','set-a/2432060.txt','set-a/2458004.txt','set-a/2460945.txt','set-a/2471471.txt','set-a/2484180.txt','set-a/2518132.txt','set-a/2526844.txt','set-a/2530638.txt','set-a/2535792.txt','set-a/2540548.txt','set-a/2544510.txt','set-a/2547535.txt','set-a/2607058.txt','set-a/2607229.txt','set-a/2608391.txt','set-a/2674090.txt','set-a/2685031.txt','set-a/2722184.txt','set-a/2734941.txt','set-a/2739210.txt','set-a/2745435.txt','set-a/2749655.txt','set-a/2750205.txt','set-a/2761488.txt','set-a/2776731.txt','set-a/2813744.txt','set-a/2814777.txt','set-a/2815290.txt','set-a/2834490.txt','set-a/2834677.txt','set-a/2835744.txt','set-a/2841710.txt','set-a/2845888.txt','set-a/2846714.txt','set-a/2846723.txt','set-a/2849336.txt','set-a/2853629.txt','set-a/2863613.txt','set-a/2930238.txt','set-a/2936700.txt','set-a/2941243.txt','set-a/2944383.txt','set-a/2945144.txt','set-a/2966470.txt','set-a/2984959.txt','set-a/2989538.txt','set-a/2990643.txt','set-a/2993457.txt'};

for i = 1:length(files) 
    file = files{i} ;
    [filepath,name,ext] = fileparts(file);
    for lead = 2:13
         [kSQI_01_v,sSQI_01_v, pSQI_01_v, SQI_rel_powerLine_01_v,cSQI_01_v, basSQI_01_v,dSQI_01_v,geometricMean_V,averageGeometricMean] = mSQI(ImportPhysionetData(file, lead), 500);
         fprintf("Indexes for %s, lead %i:  averageGeometricMean: %f \n ",file,lead,averageGeometricMean);
         meanVector_unaccFile(lead-1) = averageGeometricMean;
    end
    index1_u = mean(meanVector_unaccFile);
    index2_u = geomean(meanVector_unaccFile,'all');
    meanVectorU_changed = changeZeros(meanVector_unaccFile);
    index3_u = geomean(meanVectorU_changed);
    arit_meanU = round(index1_u,5);
    geo_mean1U = round(index2_u,5);
    geo_mean2U = round(index3_u,5);
    fprintf(unacc_file,'%s ',name);

for j  = 1:length(meanVector_unaccFile)
     fprintf(acc_file,'%f ',meanVector_unaccFile(j));
end

    fprintf(unacc_file,'%f ',arit_meanU);
    fprintf(unacc_file,'%f ',geo_mean1U);
    fprintf(unacc_file,'%f\n',geo_mean2U);
    fprintf("\n ");
end 

fclose(unacc_file);

function [mean_vector01] = changeZeros(mean_vector)
for i=1:length(mean_vector)
    if mean_vector(i) < 0.01
        mean_vector(i) = 0.01;
    end
end
mean_vector01 = mean_vector;
end
